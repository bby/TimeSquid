package com.label.timesquid{	import flash.events.Event;	import com.label.timesquid.*;	import com.label.timesquid.bill.*;	import com.label.arduino.*;	import com.label.arduino.sensor.*;		import flash.display.MovieClip;	import flash.events.MouseEvent;	import fl.transitions.Fade;	public class TimeSquid extends MovieClip	{		public var rabbit_anim:MovieClip;		public var mary:MovieClip;		public var hit_area:MovieClip;		public var billArm:com.label.timesquid.bill.Arm;		public var startButton:MovieClip;		public var armCalibButton:MovieClip;		public var handCalibButton:MovieClip;		public var startSceneButton:MovieClip;				public var calibrator:Calibrator;						var em:EventManager;		var armSensor:FlexSensor;		var handSensor:FlexSensor;				public var mouth:Mouth;		public function TimeSquid()		{						stop();			//Set button names			startButton.buttonText.text = "Start Listener";			armCalibButton.buttonText.text = "Arm Calibration";			handCalibButton.buttonText.text = "Hand Calibration";			startSceneButton.buttonText.text = "Start";						//rabbit_anim.visible = false;						//mouth.setup();			startButton.addEventListener(MouseEvent.CLICK, setup);						armCalibButton.alpha=0.5;			handCalibButton.alpha=0.5;			startSceneButton.alpha=0.5;					}				//Set up sensors		public function setup(e:Event):void		{						armSensor = new FlexSensor();			armSensor.setCalibration(210, 375);			handSensor = new FlexSensor();			handSensor.setCalibration(125, 315);						em = EventManager.getInstance();			em.initialize("127.0.0.1", 5331);						em.setTestMode(false);						//Set up Sensors			em.registerAnalogueSensor(armSensor, 3);			em.registerAnalogueSensor(handSensor, 4);									em.connect();			if (false)			{				this.addEventListener(Event.ENTER_FRAME, em.test);			}			//var aSocket = new Limb("127.0.0.1",5331,arm,arm.bills_hand);			//aSocket.connect();						//aSocket.addEventListener("ArduinoReady", setup);						//Enable calibrators			armCalibButton.alpha=1;			handCalibButton.alpha=1;			startSceneButton.alpha=1;			armCalibButton.addEventListener(MouseEvent.CLICK, startArmCalibration);			handCalibButton.addEventListener(MouseEvent.CLICK, startHandCalibration);			startSceneButton.addEventListener(MouseEvent.CLICK, startScene);		}				public function addSensorListeners()		{						armSensor.addEventListener(SensorEvent.NEW_VALUE, billArm.sensorEvent)			handSensor.addEventListener(SensorEvent.NEW_VALUE, billArm.bills_hand.sensorEvent)		}				protected function initCalibrator(sensor:FlexSensor):void		{			if (calibrator!=null)			{				this.removeChild(calibrator);				var tempSensor = calibrator.sensor;				if (tempSensor!=null)				{					sensor.removeEventListener(SensorEvent.NEW_VALUE, calibrator.sensorEvent)				}				calibrator = null;			}						//Add to movie clip			calibrator = new Calibrator(armSensor);			this.addChild(calibrator);						//Centre			calibrator.x = 400;			calibrator.y = 300;						//Add Listeners			sensor.addEventListener(SensorEvent.NEW_VALUE, calibrator.sensorEvent)			calibrator.addEventListener(Event.CLOSE, closeCalibrator);		}				protected function startArmCalibration(e:Event):void		{			this.initCalibrator(armSensor);		}				protected function startHandCalibration(e:Event):void		{			this.initCalibrator(handSensor);		}				/**		 * Closes the calibrator		 */		protected function closeCalibrator(e:Event):void		{			if (calibrator!=null)			{				this.removeChild(calibrator);				calibrator = null;			}		}				/**		 * Starts the animation scene		 */		 protected function startScene(e:Event):void		 {			 trace("START");		 }			}}